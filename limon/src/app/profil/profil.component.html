
<section class="profil">
    <form *ngIf="userForm" [formGroup]="userForm" (ngSubmit)="onSubmitForm()">
    <div *ngIf="errors.length > 0" class="error">
        <p *ngFor="let error of errors">{{ error }}</p>
    </div>
    <section class="profil-main">
        <img *ngIf="mail" src="{{ 'https://www.gravatar.com/avatar/' + mail + '?s=200&d=https%3A%2F%2Flimon.app-tricycle.com%2Fassets%2Fprofil-notfound.png' || '../../assets/profil-notfound.png'}}" alt="Photo de profil" class="profil-main-pic">
        <div class="profil-main-infos">
            <h1 *ngIf="!isEdit">{{ user?.fullname }}</h1>
            <input type="text" formControlName="fullname" class="input-name" value="{{ user?.fullname }}" *ngIf="isEdit">
            <div *ngIf="isPremium"><img src="../../assets/icons/badge.png" alt="Compte premium" class="profil-main-badge">Premium</div>
        </div>  
        <div class="sup-deconnect sup2" *ngIf="!isEdit && isAdmin">
            <button class="deconnect ad-light" routerLink="/admin" type="button">Accéder à l'administration</button>
        </div>
        <img src="../../assets/icons/settings-icon.png" alt="Paramètres" class="profil-main-settings" (click)="onOpenSettings()">
        <div *ngIf="isSettings" class="profil-main-popup">
            <a (click)="onEdit();onOpenSettings();">Modifier les informations</a>
            <a (click)="onDelete();onOpenSettings()">Supprimer le compte</a>
        </div>
    </section>
    <section class="profil-sup">
        <div>
            <h2>Adresse mail</h2>
            <p *ngIf="!isEdit">{{ user?.email }}</p>
            <input type="text" formControlName="email" value="{{ user?.email }}" *ngIf="isEdit">
        </div>
        <div>
            <h2>Date de naissance</h2>
            <p *ngIf="!isEdit">{{ user?.birthday | date: 'MMMM d, y' }}</p>
            <input type="text" formControlName="birthday" value="{{ user?.birthday | date: 'MMMM d, y' }}" *ngIf="isEdit">
        </div>
        <div class="sup-deconnect" *ngIf="!isEdit">
            <button class="deconnect" (click)="logout()" type="button">Se déconnecter</button>
        </div>
    </section>
    <section class="profil-access">
        <button routerLink="/history" *ngIf="!isEdit" type="button">
            <img src="../../assets/icons/history-icon.png" alt=""> Consulter l'historique
        </button>
        <button routerLink="/watchlist" *ngIf="!isEdit" type="button">
            <img src="../../assets/icons/watchlist-icon.png" alt=""> Consulter votre watchlist
        </button>
        <button routerLink="/purchase" type="button">
            <img src="../../assets/icons/achat-icon.png" alt=""> Voir les Films achetés
        </button>

        <button *ngIf="isEdit" type="submit" [disabled]="userForm.invalid">
            Enregistrer les modifications
        </button>

    </section>
</form>
</section>
